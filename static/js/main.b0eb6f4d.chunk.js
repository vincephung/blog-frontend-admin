(this["webpackJsonpblog-frontend-admin"]=this["webpackJsonpblog-frontend-admin"]||[]).push([[0],{26:function(e,t,a){e.exports=a(43)},31:function(e,t,a){},32:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(15),o=a.n(c),s=(a(31),a(32),a(33),a(3)),l=a.n(s),i=a(8),u=a(5),m=a(4),p=function(){var e=Object(m.f)(),t=Object(n.useState)(""),a=Object(u.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(""),p=Object(u.a)(s,2),h=p[0],b=p[1],d=Object(n.useState)({message:""}),f=Object(u.a)(d,2),g=f[0],v=f[1],E=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),"https://vincephung-blog.glitch.me/api/log-in",t.next=4,fetch("https://vincephung-blog.glitch.me/api/log-in",{mode:"cors",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:c,password:h})});case 4:return n=t.sent,t.next=7,n.json();case 7:if(!(r=t.sent).token){t.next=13;break}return localStorage.setItem("user",JSON.stringify(r)),e.push({pathname:"/home"}),window.location.reload(),t.abrupt("return");case 13:v(r),o(""),b("");case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(e){var t=e.target,a=t.name,n=t.value;"username"===a?o(n):b(n)};return r.a.createElement("div",{className:"form-container",onSubmit:E},r.a.createElement("form",{className:"log-in-form"},r.a.createElement("p",null,g.message),r.a.createElement("label",{htmlFor:"username"},"Username:"),r.a.createElement("input",{type:"text",name:"username",value:c,onChange:j,required:!0}),r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"text",name:"password",value:h,onChange:j,required:!0}),r.a.createElement("button",{type:"submit"},"Log in")))},h=function(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?"Bearer ".concat(e.token):{}},b=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),s=Object(u.a)(o,2),p=s[0],b=s[1],d=Object(n.useState)("false"),f=Object(u.a)(d,2),g=f[0],v=f[1],E=Object(n.useState)(""),j=Object(u.a)(E,2),O=j[0],x=j[1],k=Object(n.useState)([]),y=Object(u.a)(k,2),S=y[0],w=y[1],C=Object(m.f)(),N=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,"https://vincephung-blog.glitch.me/api/posts",e.next=5,fetch("https://vincephung-blog.glitch.me/api/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:h()},mode:"cors",body:JSON.stringify({title:a,content:p,published:g,image:O})});case 5:return n=e.sent,e.next=8,n.json();case 8:if(r=e.sent,console.log(n),400!==n.status){e.next=13;break}return w(r),e.abrupt("return");case 13:C.push("/home"),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0),w([{msg:"User not authenticated, please log in to post"}]);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"postFormContainer"},r.a.createElement("form",{className:"postForm",onSubmit:N},r.a.createElement("div",null,S.map((function(e){return r.a.createElement("li",{key:e.msg},e.msg)}))),r.a.createElement("label",{htmlFor:"title"},"Title:"),r.a.createElement("input",{name:"title",type:"text",value:a,onChange:function(e){return c(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"content"},"Post Content:"),r.a.createElement("textarea",{rows:"3",name:"content",value:p,onChange:function(e){return b(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"published"},"Published? "),r.a.createElement("input",{name:"published",type:"checkbox",checked:!0===g,onChange:function(e){v(!g)}}),r.a.createElement("label",{htmlFor:"image"},"Image URL:"),r.a.createElement("input",{name:"image",type:"url",value:O,onChange:function(e){return x(e.target.value)}}),r.a.createElement("button",{className:"submitForm",type:"submit"},"Submit")))},d=a(22),f=a.n(d),g=(a(41),function(e){var t=e.match,a=e.location,c=Object(n.useState)(a.state.title||""),o=Object(u.a)(c,2),s=o[0],p=o[1],b=Object(n.useState)(a.state.content||""),d=Object(u.a)(b,2),g=d[0],v=d[1],E=Object(n.useState)(a.state.published||"false"),j=Object(u.a)(E,2),O=j[0],x=j[1],k=Object(n.useState)(a.state.image||""),y=Object(u.a)(k,2),S=y[0],w=y[1],C=Object(n.useState)([]),N=Object(u.a)(C,2),P=N[0],F=N[1],T=Object(m.f)(),U=function(){var e=Object(i.a)(l.a.mark((function e(a){var n,r,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,n=f()().format("MMMM Do[,] YYYY"),r="https://vincephung-blog.glitch.me/api/posts/".concat(t.params.id),e.next=6,fetch(r,{mode:"cors",method:"PUT",headers:{"Content-Type":"application/json",Authorization:h()},body:JSON.stringify({title:s,content:g,published:O,image:S,lastUpdate:n})});case 6:return c=e.sent,e.next=9,c.json();case 9:if(o=e.sent,400!==c.status){e.next=13;break}return F(o),e.abrupt("return");case 13:T.push("/home"),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0),F([{msg:"User not authenticated, please log in to edit"}]);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(i.a)(l.a.mark((function e(a){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,n=f()().format("MMMM Do[,] YYYY"),r="https://vincephung-blog.glitch.me/api/posts/".concat(t.params.id),e.next=6,fetch(r,{mode:"cors",method:"DELETE",headers:{"Content-Type":"application/json",Authorization:h()},body:JSON.stringify({title:s,content:g,published:O,image:S,lastUpdate:n})});case 6:return c=e.sent,e.next=9,c.json();case 9:e.sent,T.push("/home"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0),F([{msg:"User not authenticated, please log in to edit"}]);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"EditPostFormContainer"},r.a.createElement("form",{className:"EditPostForm",onSubmit:U},r.a.createElement("h1",null,"Edit form "),r.a.createElement("div",null,P.map((function(e){return r.a.createElement("li",{key:e.msg},e.msg)}))),r.a.createElement("label",{htmlFor:"title"},"Title:"),r.a.createElement("input",{name:"title",type:"text",value:s,onChange:function(e){return p(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"content"},"Post Content:"),r.a.createElement("textarea",{rows:"3",name:"content",value:g,onChange:function(e){return v(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"published"},"Published?",r.a.createElement("input",{name:"published",type:"checkbox",checked:!0===O,onChange:function(e){x(!O)}})),r.a.createElement("label",{htmlFor:"image"},"Image URL:"),r.a.createElement("input",{name:"image",type:"url",value:S,onChange:function(e){return w(e.target.value)}}),r.a.createElement("button",{className:"deleteBtn",onClick:D,type:"submit"},"Delete"),r.a.createElement("button",{className:"submitForm",type:"submit"},"Submit")))}),v=(a(42),function(e){var t=Object(m.f)(),a=function(){var a=Object(i.a)(l.a.mark((function a(n){var r,c,o,s,i,u,m;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),r="https://vincephung-blog.glitch.me/api/posts/".concat(e._id),a.next=4,fetch(r,{mode:"cors"});case 4:return c=a.sent,a.next=7,c.json();case 7:o=a.sent,s=o.title,i=o.content,u=o.published,m=o.image,t.push({pathname:"/posts/".concat(e._id),state:{title:s,content:i,published:u,image:m}});case 10:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),n=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n="https://vincephung-blog.glitch.me/api/posts/".concat(e._id,"/publish"),t.next=4,fetch(n,{mode:"cors",method:"PUT",headers:{"Content-Type":"application/json",Authorization:h()},body:JSON.stringify({published:!e.published})});case 4:return r=t.sent,t.next=7,r.json();case 7:t.sent,window.location.reload();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"postContainer"},r.a.createElement("div",{className:"postSection"},r.a.createElement("h1",{className:"postTitle"},e.title),r.a.createElement("hr",null),r.a.createElement("p",{className:"postDate"},"Posted on ",e.timestamp),r.a.createElement("hr",null),r.a.createElement("img",{className:"postPicture",src:e.image,alt:"post img"}),r.a.createElement("hr",null),r.a.createElement("p",{className:"postContent"},e.postContent),r.a.createElement("p",{className:"postPublished"},"Published : ",String(e.published)),r.a.createElement("hr",null),r.a.createElement("button",{className:"showComments",onClick:function(a){a.preventDefault(),t.push({pathname:"/posts/".concat(e._id,"/comments")})}},"Show comments"),r.a.createElement("button",{className:"publishPost",onClick:n},"Publish/Unpublish"),r.a.createElement("button",{className:"editPost",onClick:a},"Edit Post")))}),E=a(17),j=a(7),O=function(e){var t=e.user,a=Object(n.useState)([]),c=Object(u.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)((function(){(function(){var e=Object(i.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://vincephung-blog.glitch.me/api/posts",e.next=3,fetch("https://vincephung-blog.glitch.me/api/posts",{mode:"cors"});case 3:if(!(t=e.sent).ok){e.next=9;break}return e.next=7,t.json();case 7:a=e.sent,s(a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement("div",{className:"postListContainer"},r.a.createElement("div",null,r.a.createElement(E.a,{variant:"dark"},r.a.createElement(j.b,{to:"/posts"},"Create new post"))),o.map((function(e){return r.a.createElement(v,{title:e.title,published:e.published,lastUpdate:e.lastUpdate,image:e.image,timestamp:e.timestamp,key:e._id,_id:e._id,user:t})})))},x=function(e){return r.a.createElement("div",{className:"comment"},r.a.createElement("h1",null,e.author),r.a.createElement("p",null,e.content),r.a.createElement("p",null,e.timestamp))},k=function(e){var t=e.match,a=Object(n.useState)([]),c=Object(u.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)((function(){(function(){var e=Object(i.a)(l.a.mark((function e(){var a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="https://vincephung-blog.glitch.me/api/posts/".concat(t.params.id,"/comments"),e.next=3,fetch(a,{mode:"cors"});case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:r=e.sent,s(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.params.id]),r.a.createElement("div",{className:"commentContainer"},o.map((function(e){return r.a.createElement(x,{key:e._id,author:e.author,content:e.content,timestamp:e.timestamp})})))},y=a(16),S=function(){return JSON.parse(localStorage.getItem("user"))},w=function(){return localStorage.removeItem("user"),window.location.reload(),JSON.parse(localStorage.getItem("user"))},C=function(){var e=S();return r.a.createElement(y.a,{bg:"dark",variant:"dark"},r.a.createElement(y.a.Brand,null,r.a.createElement(j.b,{to:"/home"},"Blog Home")),r.a.createElement(y.a.Toggle,null),r.a.createElement(y.a.Collapse,{className:"justify-content-end"},e?r.a.createElement("div",null,r.a.createElement(y.a.Text,null,"Signed in as: ",e.username),r.a.createElement(E.a,{variant:"dark",onClick:w},r.a.createElement(j.b,{to:"/home"},"Sign out "))):r.a.createElement(E.a,{variant:"dark"},r.a.createElement(j.b,{to:"/log-in"},"Log in "))))},N=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"This page does not exist.",r.a.createElement(j.b,{to:"/home"},"Click this to go back to the homepage.")))};var P=function(){return r.a.createElement(j.a,{basename:"/blog-frontend-admin"},r.a.createElement(C,null),r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/home",component:O}),r.a.createElement(m.a,{exact:!0,path:"/log-in",component:p}),r.a.createElement(m.a,{exact:!0,path:"/posts",component:b}),r.a.createElement(m.a,{exact:!0,path:"/posts/:id/",component:g}),r.a.createElement(m.a,{exact:!0,path:"/posts/:id/comments",component:k}),r.a.createElement(m.a,{path:"/",component:N})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.b0eb6f4d.chunk.js.map